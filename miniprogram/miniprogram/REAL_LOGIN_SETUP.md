# çœŸå®ç™»å½•é…ç½®æŒ‡å—

## ğŸ“‹ é…ç½®æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°†å°ç¨‹åºä»æ¨¡æ‹Ÿæ•°æ®æ¨¡å¼åˆ‡æ¢åˆ°çœŸå®åç«¯è¿æ¥æ¨¡å¼ã€‚

## âœ… å·²å®Œæˆçš„é…ç½®ä¿®æ”¹

### 1. é…ç½®æ–‡ä»¶ä¿®æ”¹
- âœ… å…³é—­æ¨¡æ‹Ÿæ•°æ®æ¨¡å¼ (`useMockData: false`)
- âœ… å¢åŠ ç½‘ç»œè¶…æ—¶æ—¶é—´ (15ç§’)
- âœ… å¢åŠ é‡è¯•æ¬¡æ•° (3æ¬¡)
- âœ… æ¸…ç©ºé»˜è®¤ç™»å½•ä¿¡æ¯

### 2. ç™»å½•é¡µé¢ä¿®æ”¹
- âœ… ç§»é™¤æ¨¡æ‹Ÿæ•°æ®æŒ‡ç¤ºå™¨
- âœ… ç§»é™¤é»˜è®¤ç”¨æˆ·åå¯†ç 
- âœ… ä¼˜åŒ–éªŒè¯ç è·å–é€»è¾‘
- âœ… å¢å¼ºé”™è¯¯å¤„ç†

### 3. ç½‘ç»œè¯·æ±‚ä¿®æ”¹
- âœ… ç§»é™¤æ¨¡æ‹Ÿæ•°æ®ä»£ç 
- âœ… ä¼˜åŒ–çœŸå®ç½‘ç»œè¯·æ±‚
- âœ… å¢å¼ºé”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ”§ åç«¯æœåŠ¡é…ç½®

### 1. ç¡®è®¤åç«¯æœåŠ¡çŠ¶æ€

è¯·ç¡®è®¤æ‚¨çš„åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼š

```bash
# æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ
curl http://10.148.11.100:8080/captchaImage

# æˆ–è€…ä½¿ç”¨æµè§ˆå™¨è®¿é—®
http://10.148.11.100:8080/captchaImage
```

### 2. åç«¯æœåŠ¡è¦æ±‚

ç¡®ä¿åç«¯æœåŠ¡æä¾›ä»¥ä¸‹æ¥å£ï¼š

#### éªŒè¯ç æ¥å£
```
GET /captchaImage
å“åº”æ ¼å¼ï¼š
{
  "img": "base64ç¼–ç çš„å›¾ç‰‡",
  "uuid": "éªŒè¯ç æ ‡è¯†"
}
```

#### ç™»å½•æ¥å£
```
POST /login
è¯·æ±‚å‚æ•°ï¼š
{
  "username": "ç”¨æˆ·å",
  "password": "å¯†ç ",
  "code": "éªŒè¯ç ",
  "uuid": "éªŒè¯ç æ ‡è¯†"
}
å“åº”æ ¼å¼ï¼š
{
  "token": "JWTä»¤ç‰Œ",
  "user": {
    "userId": 1,
    "username": "ç”¨æˆ·å",
    "nickname": "æ˜µç§°"
  }
}
```

#### ç”¨æˆ·ä¿¡æ¯æ¥å£
```
GET /getInfo
è¯·æ±‚å¤´ï¼šAuthorization: Bearer {token}
å“åº”æ ¼å¼ï¼š
{
  "user": {
    "userId": 1,
    "username": "ç”¨æˆ·å",
    "nickname": "æ˜µç§°",
    "email": "é‚®ç®±",
    "phone": "æ‰‹æœºå·"
  }
}
```

## ğŸŒ ç½‘ç»œé…ç½®

### 1. å¾®ä¿¡å¼€å‘è€…å·¥å…·è®¾ç½®

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š

1. **é¡¹ç›®è®¾ç½®** â†’ **æœ¬åœ°è®¾ç½®**
2. **ä¸æ ¡éªŒåˆæ³•åŸŸåã€web-viewï¼ˆä¸šåŠ¡åŸŸåï¼‰ã€TLS ç‰ˆæœ¬ä»¥åŠ HTTPS è¯ä¹¦æ£€æŸ¥** âœ…
3. **ä¸æ ¡éªŒå®‰å…¨åŸŸåã€TLS ç‰ˆæœ¬ä»¥åŠ HTTPS è¯ä¹¦æ£€æŸ¥** âœ…

### 2. ç½‘ç»œåœ°å€é…ç½®

å½“å‰é…ç½®çš„åç«¯åœ°å€ï¼š
```javascript
baseUrl: 'http://10.148.11.100:8080'
```

å¦‚éœ€ä¿®æ”¹ï¼Œè¯·ç¼–è¾‘ `utils/config.js`ï¼š
```javascript
env: {
  baseUrl: 'http://your-backend-ip:port'
}
```

## ğŸ” æµ‹è¯•æ­¥éª¤

### 1. éªŒè¯ç æµ‹è¯•
1. æ‰“å¼€å°ç¨‹åº
2. æŸ¥çœ‹éªŒè¯ç æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
3. ç‚¹å‡»éªŒè¯ç æ˜¯å¦èƒ½å¤Ÿåˆ·æ–°

### 2. ç™»å½•æµ‹è¯•
1. è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç 
2. è¾“å…¥éªŒè¯ç 
3. ç‚¹å‡»ç™»å½•æŒ‰é’®
4. æ£€æŸ¥æ˜¯å¦æˆåŠŸè·³è½¬åˆ°é¦–é¡µ

### 3. åŠŸèƒ½æµ‹è¯•
1. æµ‹è¯•å„é¡µé¢è·³è½¬
2. æµ‹è¯•æ•°æ®åŠ è½½
3. æµ‹è¯•ç”¨æˆ·äº¤äº’åŠŸèƒ½

## ğŸš¨ å¸¸è§é—®é¢˜è§£å†³

### 1. éªŒè¯ç è·å–å¤±è´¥

**é—®é¢˜**: éªŒè¯ç å›¾ç‰‡ä¸æ˜¾ç¤ºæˆ–è·å–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// æ£€æŸ¥åç«¯æ¥å£æ˜¯å¦æ­£å¸¸
curl http://10.148.11.100:8080/captchaImage

// æ£€æŸ¥ç½‘ç»œè¿æ¥
ping 10.148.11.100

// æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
```

### 2. ç™»å½•å¤±è´¥

**é—®é¢˜**: ç™»å½•æ—¶æç¤ºç½‘ç»œé”™è¯¯æˆ–è®¤è¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ç”¨æˆ·åå¯†ç æ­£ç¡®
2. ç¡®è®¤éªŒè¯ç è¾“å…¥æ­£ç¡®
3. æ£€æŸ¥åç«¯ç™»å½•æ¥å£æ˜¯å¦æ­£å¸¸
4. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚æ—¥å¿—

### 3. ç½‘ç»œè¶…æ—¶

**é—®é¢˜**: è¯·æ±‚è¶…æ—¶é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```javascript
// å¢åŠ è¶…æ—¶æ—¶é—´
network: {
  timeout: 20000, // å¢åŠ åˆ°20ç§’
  retryTimes: 3,
  retryDelay: 1000
}
```

### 4. CORSé”™è¯¯

**é—®é¢˜**: è·¨åŸŸè¯·æ±‚è¢«é˜»æ­¢

**è§£å†³æ–¹æ¡ˆ**:
1. åç«¯éœ€è¦é…ç½®CORS
2. æˆ–è€…ä½¿ç”¨ä»£ç†æœåŠ¡å™¨
3. æˆ–è€…é…ç½®å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸æ ¡éªŒåŸŸå

## ğŸ“± çœŸæœºè°ƒè¯•

### 1. çœŸæœºè°ƒè¯•é…ç½®

1. **å¾®ä¿¡å¼€å‘è€…å·¥å…·** â†’ **é¢„è§ˆ**
2. ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç 
3. åœ¨æ‰‹æœºä¸Šæ‰“å¼€å°ç¨‹åº

### 2. çœŸæœºè°ƒè¯•æ³¨æ„äº‹é¡¹

- çœŸæœºè°ƒè¯•éœ€è¦HTTPSåè®®
- éœ€è¦é…ç½®åˆæ³•åŸŸå
- å»ºè®®ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·

### 3. å†…ç½‘ç©¿é€å·¥å…·

æ¨èä½¿ç”¨ä»¥ä¸‹å·¥å…·è¿›è¡Œå†…ç½‘ç©¿é€ï¼š

```bash
# ä½¿ç”¨ ngrok
ngrok http 8080

# ä½¿ç”¨ frp
frpc -c frpc.ini

# ä½¿ç”¨ natapp
natapp -authtoken=your-token
```

## ğŸ” å®‰å…¨é…ç½®

### 1. HTTPSé…ç½®

ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPSï¼š

```javascript
env: {
  baseUrl: 'https://your-domain.com'
}
```

### 2. åŸŸåé…ç½®

åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®åˆæ³•åŸŸåï¼š

1. **å¼€å‘** â†’ **å¼€å‘ç®¡ç†** â†’ **å¼€å‘è®¾ç½®**
2. **æœåŠ¡å™¨åŸŸå** â†’ **requeståˆæ³•åŸŸå**
3. æ·»åŠ æ‚¨çš„åç«¯åŸŸå

### 3. Tokenå®‰å…¨

ç¡®ä¿JWT tokençš„å®‰å…¨æ€§ï¼š

```javascript
// è®¾ç½®tokenè¿‡æœŸæ—¶é—´
const tokenExpireTime = 24 * 60 * 60 * 1000; // 24å°æ—¶

// å®šæœŸåˆ·æ–°token
function refreshToken() {
  // å®ç°tokenåˆ·æ–°é€»è¾‘
}
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. ç½‘ç»œè¯·æ±‚ç›‘æ§

```javascript
// åœ¨request.jsä¸­æ·»åŠ ç›‘æ§
console.log('è¯·æ±‚å¼€å§‹:', {
  url: fullUrl,
  method: method.toUpperCase(),
  timestamp: new Date().toISOString()
});

console.log('è¯·æ±‚å®Œæˆ:', {
  url: fullUrl,
  statusCode: res.statusCode,
  duration: Date.now() - startTime
});
```

### 2. é”™è¯¯æ—¥å¿—æ”¶é›†

```javascript
// é”™è¯¯å¤„ç†
function handleError(error) {
  console.error('è¯·æ±‚é”™è¯¯:', {
    url: error.url,
    message: error.message,
    timestamp: new Date().toISOString()
  });
  
  // å¯ä»¥å‘é€åˆ°é”™è¯¯æ”¶é›†æœåŠ¡
  // sendErrorToService(error);
}
```

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–

### 1. è¯·æ±‚ä¼˜åŒ–

```javascript
// è¯·æ±‚ç¼“å­˜
const requestCache = new Map();

function cachedRequest(options) {
  const cacheKey = JSON.stringify(options);
  if (requestCache.has(cacheKey)) {
    return Promise.resolve(requestCache.get(cacheKey));
  }
  
  return request(options).then(result => {
    requestCache.set(cacheKey, result);
    return result;
  });
}
```

### 2. å›¾ç‰‡ä¼˜åŒ–

```javascript
// éªŒè¯ç å›¾ç‰‡ç¼“å­˜
function cacheCaptchaImage(imgUrl) {
  wx.getImageInfo({
    src: imgUrl,
    success: (res) => {
      // ç¼“å­˜å›¾ç‰‡ä¿¡æ¯
      wx.setStorageSync('captcha_cache', {
        url: imgUrl,
        timestamp: Date.now()
      });
    }
  });
}
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### 1. è°ƒè¯•å·¥å…·

- **å¾®ä¿¡å¼€å‘è€…å·¥å…·**: ç½‘ç»œé¢æ¿æŸ¥çœ‹è¯·æ±‚
- **Charles/Fiddler**: ç½‘ç»œä»£ç†å·¥å…·
- **Postman**: APIæµ‹è¯•å·¥å…·

### 2. æ—¥å¿—æŸ¥çœ‹

```javascript
// å¼€å¯è¯¦ç»†æ—¥å¿—
console.log('è¯¦ç»†è¯·æ±‚ä¿¡æ¯:', {
  url: fullUrl,
  method: method.toUpperCase(),
  data: data,
  headers: header
});
```

### 3. è”ç³»æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
- é”™è¯¯æ—¥å¿—
- ç½‘ç»œè¯·æ±‚è¯¦æƒ…
- åç«¯æœåŠ¡çŠ¶æ€
- å¾®ä¿¡å¼€å‘è€…å·¥å…·ç‰ˆæœ¬

---

**é…ç½®çŠ¶æ€**: âœ… å·²å®Œæˆ  
**æœ€åæ›´æ–°**: 2024å¹´7æœˆ21æ—¥  
**ç‰ˆæœ¬**: v1.0.0 