# 快速修复指南 - 真实登录模式

## 📋 当前配置状态

### ✅ 已完成的配置
- **真实登录模式**: 已启用
- **模拟数据**: 已关闭
- **后端连接**: 配置为 `http://10.148.11.100:8080`
- **网络超时**: 15秒
- **重试机制**: 3次重试

### 🔧 当前配置
```javascript
// utils/config.js
env: {
  isDev: true,
  useMockData: false,  // 真实登录模式
  baseUrl: 'http://10.148.11.100:8080'
}
```

## 🚨 常见问题解决

### 1. 验证码获取失败

**问题描述**: 验证码图片不显示或获取失败

**解决方案**:
1. **检查后端服务**
   ```bash
   curl http://10.148.11.100:8080/captchaImage
   ```

2. **检查网络连接**
   ```bash
   ping 10.148.11.100
   ```

3. **检查微信开发者工具设置**
   - 项目设置 → 本地设置
   - ✅ 不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书检查

### 2. 登录失败

**问题描述**: 输入用户名密码后登录失败

**解决方案**:
1. **确认后端服务运行**
   - 检查后端服务是否启动
   - 确认端口8080是否开放

2. **检查账号信息**
   - 确认用户名密码正确
   - 确认验证码输入正确

3. **查看网络请求日志**
   - 打开微信开发者工具
   - 查看Console面板错误信息

### 3. 网络超时

**问题描述**: 请求超时错误

**解决方案**:
```javascript
// 增加超时时间
network: {
  timeout: 20000, // 增加到20秒
  retryTimes: 3,
  retryDelay: 1000
}
```

### 4. 后端连接失败

**问题描述**: 无法连接到后端服务

**解决方案**:
1. **检查IP地址**
   - 确认 `10.148.11.100` 是否正确
   - 尝试使用 `localhost` 或 `127.0.0.1`

2. **检查端口**
   - 确认端口 `8080` 是否正确
   - 检查防火墙设置

3. **使用内网穿透**
   ```bash
   # 使用 ngrok
   ngrok http 8080
   
   # 使用 frp
   frpc -c frpc.ini
   ```

## 🔍 调试步骤

### 1. 验证后端服务

```bash
# 测试验证码接口
curl http://10.148.11.100:8080/captchaImage

# 测试登录接口
curl -X POST http://10.148.11.100:8080/login \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test","code":"1234","uuid":"test"}'
```

### 2. 检查网络配置

```bash
# 检查网络连通性
ping 10.148.11.100

# 检查端口开放
telnet 10.148.11.100 8080

# 检查防火墙
netstat -an | grep 8080
```

### 3. 微信开发者工具设置

1. **项目设置** → **本地设置**
2. ✅ **不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书检查**
3. ✅ **不校验安全域名、TLS 版本以及 HTTPS 证书检查**

## 📱 真机调试

### 1. 真机调试配置

1. **微信开发者工具** → **预览**
2. 使用微信扫描二维码
3. 在手机上打开小程序

### 2. 真机调试注意事项

- 真机调试需要HTTPS协议
- 需要配置合法域名
- 建议使用内网穿透工具

### 3. 内网穿透配置

```bash
# 使用 ngrok
ngrok http 8080

# 使用 frp
frpc -c frpc.ini

# 使用 natapp
natapp -authtoken=your-token
```

## 🔧 快速修复

### 方案1：修改后端地址

如果您的后端服务地址不同，请修改 `utils/config.js`：

```javascript
env: {
  baseUrl: 'http://your-backend-ip:port'
}
```

### 方案2：启用HTTPS

如果使用HTTPS，请修改配置：

```javascript
env: {
  baseUrl: 'https://your-domain.com'
}
```

### 方案3：临时使用模拟数据

如果后端服务不可用，可以临时启用模拟数据：

```javascript
env: {
  useMockData: true  // 临时启用模拟数据
}
```

## 📊 监控和日志

### 1. 网络请求监控

在微信开发者工具中查看：
- **Console面板**: 查看请求日志
- **Network面板**: 查看网络请求详情
- **Storage面板**: 查看存储数据

### 2. 错误日志

```javascript
// 查看详细错误信息
console.error('请求失败:', {
  url: fullUrl,
  error: err,
  timestamp: new Date().toISOString()
});
```

## 🎯 测试清单

### 功能测试
- [ ] 验证码正常显示
- [ ] 验证码可以刷新
- [ ] 登录功能正常
- [ ] 用户信息获取正常
- [ ] 页面跳转正常

### 网络测试
- [ ] 后端服务可访问
- [ ] 网络请求成功
- [ ] 响应时间正常
- [ ] 错误处理正常

### 安全测试
- [ ] Token管理正常
- [ ] 登录状态检查正常
- [ ] 权限验证正常

## 📞 获取帮助

### 1. 查看文档
- `REAL_LOGIN_SETUP.md`: 真实登录配置指南
- `TROUBLESHOOTING.md`: 详细问题诊断
- `BACKEND_CONFIG.md`: 后端配置说明

### 2. 调试工具
- **微信开发者工具**: 网络面板
- **Charles/Fiddler**: 网络代理
- **Postman**: API测试

### 3. 常见问题
- 检查防火墙设置
- 确认端口开放
- 验证网络连通性
- 查看后端日志

---

**配置状态**: ✅ 真实登录模式  
**最后更新**: 2024年7月21日  
**版本**: v1.0.0 